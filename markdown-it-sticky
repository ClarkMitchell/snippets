<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Sticky Section</title>
  <meta name="description" content="Multicolumn blog">
  <meta name="ClarkMitchell" content="Foobar">
  <script src="./node_modules/markdown-it/dist/markdown-it.min.js"></script>
  <script src="./node_modules/markdown-it-container/dist/markdown-it-container.min.js"></script>

</head>

<body>

  <div id="app"></div>

  <script>
var md = window.markdownit();

  var getSection = function (notSticky, sticky) {
    return `
      <div class="sticky-section">
        <div class="not-sticky">
          ${notSticky}
        </div>
        <div class="sticky">
          ${sticky}
        </div>
      </div>
    `;
  };


md.use(window.markdownitContainer, 'sticky', {

  validate: function(params) {
    return params.trim().match(/^sticky\s+(.*)$/);
  },

  render: function (tokens, idx) {
    var m = tokens[idx].info.trim().match(/^sticky\s+(.*)$/);

    if (tokens[idx].nesting === 1) {
      // opening tag
      return getSection(
        md.utils.escapeHtml(m[1]),
        md.utils.escapeHtml(tokens[2].content)
      );
    } else {
      // closing tag
      return '</details>\n';
    }
  }
});

const markdown = `
::: sticky unstick
biz baz
:::
`

const html = md.render(markdown);

var app = document.getElementById('app');

app.insertAdjacentHTML('afterbegin', html);

  </script>
</body>
</html>
